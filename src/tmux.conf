# Enable mouse support
set -g mouse on

# Start numbering at 1
set -g base-index 1
setw -g pane-base-index 1

# Increase history limit
set -g history-limit 10000

# Better colors - enhanced for truecolor support
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -ga terminal-overrides ",xterm-256color:Tc"
set -ga terminal-overrides ",screen-256color:Tc"
set -as terminal-overrides ',*:RGB'
set -as terminal-overrides ',*:sitm=\E[3m'

# Force color support
set -g @force_truecolor on

# Status bar customization - v2.0 (all sessions visible)
set -g status-bg colour234
set -g status-fg colour255
set -g status-position bottom
set -g status-interval 5
set -g status-left-length 250
set -g status-right-length 0

# Custom status bar showing all 7 consoles + F11/F12 tabs
set -g status-left '#(~/.vps/sessions/src/status-bar.sh "#{session_name}" "#{client_width}")'
set -g status-right ''

# Hide default window list (we have custom format)
set -g window-status-format ''
set -g window-status-current-format ''

# Easier window switching within session
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6

# Ctrl+F function keys for console switching
bind-key -n C-F1 switch-client -t console-1
bind-key -n C-F2 switch-client -t console-2
bind-key -n C-F3 switch-client -t console-3
bind-key -n C-F4 switch-client -t console-4
bind-key -n C-F5 switch-client -t console-5
bind-key -n C-F6 switch-client -t console-6
bind-key -n C-F7 switch-client -t console-7

# Mission Control and Navigation
bind-key -n C-F12 new-window -n "🎛️ Mission" "bash --noprofile --norc ~/.vps/sessions/src/mission-control.sh"

# Quick navigation (Ctrl+Arrows)
bind-key -n C-Left switch-client -p          # Previous session
bind-key -n C-Right switch-client -n         # Next session

# Safe disconnect
bind-key -n C-F8 detach-client               # Ctrl+F8: Disconnect safely

# F11 and F12 - Manager and Help windows
bind-key -n C-F11 run-shell "tmux has-session -t manager 2>/dev/null || tmux new-session -d -s manager -n 'Manager' '~/.vps/sessions/src/manager-menu.sh'; tmux switch-client -t manager"
bind-key -n C-F12 run-shell "tmux has-session -t help 2>/dev/null || tmux new-session -d -s help -n 'Help' '~/.vps/sessions/src/help-reference.sh'; tmux switch-client -t help"

# Shortcuts popup (Ctrl+H for Help)
bind-key -n C-h run-shell "tmux display-popup -E -w 50 -h 12 '~/.vps/sessions/src/shortcuts-popup.sh'"

# Restart current console with confirmation (Ctrl+R)
bind-key -n C-r run-shell "tmux display-popup -E -w 70 -h 13 '~/.vps/sessions/src/restart-confirm.sh'"

# F9-F10 are FREE for future features

# Reset session functionality
bind-key -n C-M-r send-keys 'clear && reset' Enter  # Ctrl+Alt+R: Reset current terminal

# Backup: Traditional session switching with Ctrl+b prefix
bind-key 1 switch-client -t console-1
bind-key 2 switch-client -t console-2
bind-key 3 switch-client -t console-3
bind-key 4 switch-client -t console-4
bind-key 5 switch-client -t console-5
bind-key 6 switch-client -t console-6
bind-key 7 switch-client -t console-7

# Visual session switcher
bind-key S choose-tree -s

# Quick jump to last session
bind-key L switch-client -l